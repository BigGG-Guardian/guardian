{
  "openapi": "3.0.0",
  "info": {
    "title": "Guardian Example API",
    "description": "Guardian 框架示例接口",
    "version": "2.0.0"
  },
  "servers": [
    {
      "url": "http://localhost:49999/guardian-example"
    }
  ],
  "tags": [
    { "name": "防重复提交-YAML规则" },
    { "name": "防重复提交-注解方式" },
    { "name": "接口限流-YAML规则" },
    { "name": "接口限流-注解（滑动窗口）" },
    { "name": "接口限流-注解（令牌桶）" },
    { "name": "接口幂等-Token获取" },
    { "name": "接口幂等-业务接口" },
    { "name": "参数自动trim" },
    { "name": "慢接口检测" },
    { "name": "请求链路TraceId" },
    { "name": "消息国际化(i18n)" },
    { "name": "IP黑白名单" },
    { "name": "MQ链路追踪-RabbitMQ" },
    { "name": "MQ链路追踪-Kafka" },
    { "name": "MQ链路追踪-RocketMQ" },
    { "name": "防重放攻击" },
    { "name": "接口开关" },
    { "name": "Actuator监控端点" }
  ],
  "paths": {
    "/repeat-submit/yml/whitelist": {
      "get": {
        "tags": ["防重复提交-YAML规则"],
        "summary": "YAML-白名单放行",
        "description": "此接口被 YAML exclude-urls 命中，不受防重限制。测试：快速连续请求多次，全部成功。",
        "operationId": "repeatSubmitYmlWhitelist",
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "example": "guardian"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/repeat-submit/yml/basic": {
      "post": {
        "tags": ["防重复提交-YAML规则"],
        "summary": "YAML-POST防重（user维度，10s）",
        "description": "YAML规则拦截，interval=10s。测试：提交一次后10秒内再提交相同参数被拦截。",
        "operationId": "repeatSubmitYmlBasic",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": { "type": "string" }
              },
              "example": {
                "orderId": "10001",
                "amount": "99.9"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/repeat-submit/yml/get": {
      "get": {
        "tags": ["防重复提交-YAML规则"],
        "summary": "YAML-GET防重（user维度，10s）",
        "description": "命中YAML通配规则，GET请求防重。测试：相同参数快速请求两次，第2次被拦截。",
        "operationId": "repeatSubmitYmlGet",
        "parameters": [
          {
            "name": "keyword",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "example": "test"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/repeat-submit/annotation/user-scope": {
      "post": {
        "tags": ["防重复提交-注解方式"],
        "summary": "注解-用户维度防重（10s）",
        "description": "@RepeatSubmit(interval=10, keyScope=USER)。测试：提交一次后10秒内再提交相同参数被拦截。",
        "operationId": "repeatSubmitAnnotationUserScope",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": { "type": "string" }
              },
              "example": {
                "orderId": "20001",
                "remark": "用户维度测试"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/repeat-submit/annotation/ip-scope": {
      "post": {
        "tags": ["防重复提交-注解方式"],
        "summary": "注解-IP维度防重（10s）",
        "description": "@RepeatSubmit(interval=10, keyScope=IP)。测试：提交一次后10秒内再提交相同参数被拦截。",
        "operationId": "repeatSubmitAnnotationIpScope",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": { "type": "string" }
              },
              "example": {
                "orderId": "20002",
                "remark": "IP维度测试"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/repeat-submit/annotation/global-scope": {
      "post": {
        "tags": ["防重复提交-注解方式"],
        "summary": "注解-全局维度防重（10s）",
        "description": "@RepeatSubmit(interval=10, keyScope=GLOBAL)。测试：提交一次后10秒内再提交相同参数被拦截。",
        "operationId": "repeatSubmitAnnotationGlobalScope",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": { "type": "string" }
              },
              "example": {
                "orderId": "20003",
                "remark": "全局维度测试"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/repeat-submit/annotation/long-interval": {
      "post": {
        "tags": ["防重复提交-注解方式"],
        "summary": "注解-长窗口防重（30s）",
        "description": "@RepeatSubmit(interval=30)。测试：提交一次后30秒内再提交相同参数被拦截。",
        "operationId": "repeatSubmitAnnotationLongInterval",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": { "type": "string" }
              },
              "example": {
                "orderId": "30001",
                "productName": "iPhone",
                "amount": "9999"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/repeat-submit/annotation/exception-release": {
      "post": {
        "tags": ["防重复提交-注解方式"],
        "summary": "注解-异常自动释放锁",
        "description": "@RepeatSubmit(interval=10)。测试：第1次请求业务异常锁自动释放，第2次仍可通过。",
        "operationId": "repeatSubmitAnnotationExceptionRelease",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": { "type": "string" }
              },
              "example": {
                "orderId": "40001",
                "remark": "异常释放测试"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功（实际始终抛异常）",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rate-limit/yml/search": {
      "get": {
        "tags": ["接口限流-YAML规则"],
        "summary": "YAML-全局限流（搜索接口，2QPS）",
        "description": "qps=2, window=1s, scope=global。测试：快速连续请求3次，第3次被限流。",
        "operationId": "rateLimitYmlSearch",
        "parameters": [
          {
            "name": "keyword",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "example": "guardian"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rate-limit/yml/sms": {
      "post": {
        "tags": ["接口限流-YAML规则"],
        "summary": "YAML-IP限流（短信接口，1QPS）",
        "description": "qps=1, window=1s, scope=ip。测试：连续请求2次，第2次被限流。",
        "operationId": "rateLimitYmlSms",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": { "type": "string" }
              },
              "example": {
                "phone": "13800138000",
                "code": "123456"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rate-limit/yml/seckill": {
      "post": {
        "tags": ["接口限流-YAML规则"],
        "summary": "YAML-令牌桶秒杀（capacity=5，2令牌/秒）",
        "description": "qps=2, capacity=5, token_bucket, global。初始5个令牌可突发，用完后0.5s恢复1个。",
        "operationId": "rateLimitYmlSeckill",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rate-limit/yml/whitelist": {
      "get": {
        "tags": ["接口限流-YAML规则"],
        "summary": "YAML-白名单放行",
        "description": "此接口被 exclude-urls 命中，不受限流限制。测试：快速连续请求多次，全部成功。",
        "operationId": "rateLimitYmlWhitelist",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rate-limit/annotation/global": {
      "get": {
        "tags": ["接口限流-注解（滑动窗口）"],
        "summary": "注解-全局限流（2QPS）",
        "description": "@RateLimit(qps=2)。测试：快速连续请求3次，第3次被限流。",
        "operationId": "rateLimitAnnotationGlobal",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rate-limit/annotation/ip": {
      "get": {
        "tags": ["接口限流-注解（滑动窗口）"],
        "summary": "注解-IP限流（2QPS×5s）",
        "description": "@RateLimit(qps=2, window=5, scope=IP)。测试：5秒内快速请求11次，第11次被限流。",
        "operationId": "rateLimitAnnotationIp",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rate-limit/annotation/user": {
      "get": {
        "tags": ["接口限流-注解（滑动窗口）"],
        "summary": "注解-用户限流（3QPS×5s）",
        "description": "@RateLimit(qps=3, window=5, scope=USER)。测试：5秒内快速请求16次，第16次被限流。",
        "operationId": "rateLimitAnnotationUser",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rate-limit/annotation/strict": {
      "post": {
        "tags": ["接口限流-注解（滑动窗口）"],
        "summary": "注解-极低QPS（1QPS，方便测试）",
        "description": "@RateLimit(qps=1)。测试：连续请求2次，第2次立即被限流。",
        "operationId": "rateLimitAnnotationStrict",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": { "type": "string" }
              },
              "example": {
                "action": "submit",
                "data": "strict-test"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rate-limit/annotation/minute": {
      "post": {
        "tags": ["接口限流-注解（滑动窗口）"],
        "summary": "注解-分钟级窗口（1QPS×60s）",
        "description": "@RateLimit(qps=1, window=1min, scope=IP)。60s内同一IP最多60次。",
        "operationId": "rateLimitAnnotationMinute",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rate-limit/annotation/token-bucket/basic": {
      "get": {
        "tags": ["接口限流-注解（令牌桶）"],
        "summary": "令牌桶-基本（qps=2, capacity=2）",
        "description": "初始2个令牌，第3次请求被拒。每秒补充2个。",
        "operationId": "rateLimitTokenBucketBasic",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rate-limit/annotation/token-bucket/burst": {
      "get": {
        "tags": ["接口限流-注解（令牌桶）"],
        "summary": "令牌桶-突发（qps=2, capacity=10）",
        "description": "初始10个令牌可一次打完，之后0.5s恢复1个。",
        "operationId": "rateLimitTokenBucketBurst",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rate-limit/annotation/token-bucket/ip": {
      "get": {
        "tags": ["接口限流-注解（令牌桶）"],
        "summary": "令牌桶-IP维度（qps=1, capacity=3）",
        "description": "每个IP初始3个令牌，用完后每秒恢复1个。",
        "operationId": "rateLimitTokenBucketIp",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rate-limit/annotation/token-bucket/slow-refill": {
      "get": {
        "tags": ["接口限流-注解（令牌桶）"],
        "summary": "令牌桶-分钟级补充（5令牌/min, capacity=5）",
        "description": "初始5个令牌用完后约12秒恢复1个（5/60≈0.083/秒）。",
        "operationId": "rateLimitTokenBucketSlowRefill",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/guardian/idempotent/token": {
      "get": {
        "tags": ["接口幂等-Token获取"],
        "summary": "获取幂等Token",
        "description": "传入接口唯一标识 key，返回一次性幂等 Token。Token 默认有效期 300 秒，消费一次后失效。",
        "operationId": "getIdempotentToken",
        "parameters": [
          {
            "name": "key",
            "in": "query",
            "required": true,
            "schema": { "type": "string", "example": "order-submit" },
            "description": "接口唯一标识，对应 @Idempotent(value)"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "token": { "type": "string", "example": "a1b2c3d4e5f6" },
                        "expireIn": { "type": "integer", "example": 300 },
                        "expireUnit": { "type": "string", "example": "SECONDS" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/idempotent/header": {
      "post": {
        "tags": ["接口幂等-业务接口"],
        "summary": "Header方式传Token",
        "description": "请求头携带 X-Idempotent-Token，首次消费成功，重复请求被拒绝。先调用 GET /guardian/idempotent/token?key=order-submit 获取 Token。",
        "operationId": "idempotentHeader",
        "parameters": [
          {
            "name": "X-Idempotent-Token",
            "in": "header",
            "required": true,
            "schema": { "type": "string" },
            "description": "幂等Token"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "orderId": { "type": "string", "example": "ORD-001" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/idempotent/param": {
      "post": {
        "tags": ["接口幂等-业务接口"],
        "summary": "Param方式传Token",
        "description": "通过请求参数传递 Token。先调用 GET /guardian/idempotent/token?key=pay-confirm 获取 Token。",
        "operationId": "idempotentParam",
        "parameters": [
          {
            "name": "token",
            "in": "query",
            "required": true,
            "schema": { "type": "string" },
            "description": "幂等Token（请求参数方式）"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "amount": { "type": "string", "example": "99.99" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/idempotent/body-token": {
      "post": {
        "tags": ["接口幂等-业务接口"],
        "summary": "JSON Body方式传Token",
        "description": "Token 嵌在 JSON 请求体中，PARAM 模式自动解析 Body 中的 token 字段。先调用 GET /guardian/idempotent/token?key=body-token 获取 Token。",
        "operationId": "idempotentBodyToken",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "token": { "type": "string", "example": "从Token接口获取" },
                  "orderId": { "type": "string", "example": "ORD-002" },
                  "amount": { "type": "string", "example": "199.99" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/idempotent/custom-token-name": {
      "post": {
        "tags": ["接口幂等-业务接口"],
        "summary": "自定义tokenName",
        "description": "Header 名改为 X-Pay-Token。先调用 GET /guardian/idempotent/token?key=custom-token 获取 Token。",
        "operationId": "idempotentCustomTokenName",
        "parameters": [
          {
            "name": "X-Pay-Token",
            "in": "header",
            "required": true,
            "schema": { "type": "string" },
            "description": "自定义名称的幂等Token"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "data": { "type": "string", "example": "test" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/idempotent/null-return": {
      "post": {
        "tags": ["接口幂等-业务接口"],
        "summary": "返回null（验证缓存null场景）",
        "description": "Controller 返回 null，验证结果缓存对 null 的处理。先调用 GET /guardian/idempotent/token?key=null-return 获取 Token。",
        "operationId": "idempotentNullReturn",
        "parameters": [
          {
            "name": "X-Idempotent-Token",
            "in": "header",
            "required": true,
            "schema": { "type": "string" },
            "description": "幂等Token"
          }
        ],
        "responses": {
          "200": {
            "description": "成功（返回 null）"
          }
        }
      }
    },
    "/idempotent/custom-message": {
      "post": {
        "tags": ["接口幂等-业务接口"],
        "summary": "自定义拒绝提示",
        "description": "自定义 message 提示信息。先调用 GET /guardian/idempotent/token?key=custom-msg 获取 Token。",
        "operationId": "idempotentCustomMessage",
        "parameters": [
          {
            "name": "X-Idempotent-Token",
            "in": "header",
            "required": true,
            "schema": { "type": "string" },
            "description": "幂等Token"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "data": { "type": "string", "example": "test" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/auto-trim/form": {
      "get": {
        "tags": ["参数自动trim"],
        "summary": "表单参数trim",
        "description": "GET 请求，query 参数前后空格自动去除。测试：传入 name=\" guardian \"&email=\" test@test.com \"，返回值中空格被去除。",
        "operationId": "autoTrimForm",
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "required": true,
            "schema": { "type": "string", "example": "  guardian  " },
            "description": "姓名（前后带空格，验证trim效果）"
          },
          {
            "name": "email",
            "in": "query",
            "required": true,
            "schema": { "type": "string", "example": "  test@test.com  " },
            "description": "邮箱（前后带空格，验证trim效果）"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "name": { "type": "string", "example": "guardian" },
                        "email": { "type": "string", "example": "test@test.com" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/auto-trim/json": {
      "post": {
        "tags": ["参数自动trim"],
        "summary": "JSON Body trim",
        "description": "POST 请求，JSON 字段值前后空格自动去除。测试：传入带空格的 JSON 字段值，返回值中空格被去除。",
        "operationId": "autoTrimJson",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "username": { "type": "string", "example": "  admin  " },
                  "nickname": { "type": "string", "example": "  测试用户  " },
                  "remark": { "type": "string", "example": "  这是一条备注  " }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "username": { "type": "string", "example": "admin" },
                        "nickname": { "type": "string", "example": "测试用户" },
                        "remark": { "type": "string", "example": "这是一条备注" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/auto-trim/exclude": {
      "post": {
        "tags": ["参数自动trim"],
        "summary": "排除字段验证（表单）",
        "description": "password 字段配置在 exclude-fields 中，不会被 trim。测试：username 和 password 都传带空格的值，username 被 trim，password 保持原样。",
        "operationId": "autoTrimExclude",
        "parameters": [
          {
            "name": "username",
            "in": "query",
            "required": true,
            "schema": { "type": "string", "example": "  admin  " },
            "description": "用户名（会被trim）"
          },
          {
            "name": "password",
            "in": "query",
            "required": true,
            "schema": { "type": "string", "example": "  abc 123  " },
            "description": "密码（exclude-fields，不会被trim）"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "username": { "type": "string", "example": "admin" },
                        "password": { "type": "string", "example": "  abc 123  " }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/auto-trim/json-exclude": {
      "post": {
        "tags": ["参数自动trim"],
        "summary": "排除字段验证（JSON）",
        "description": "JSON body 中 signature 字段配置在 exclude-fields 中，不会被 trim。测试：name 被 trim，signature 保持原样。",
        "operationId": "autoTrimJsonExclude",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": { "type": "string", "example": "  guardian  " },
                  "signature": { "type": "string", "example": "  abc123==  " }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "name": { "type": "string", "example": "guardian" },
                        "signature": { "type": "string", "example": "  abc123==  " }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/auto-trim/sanitize": {
      "post": {
        "tags": ["参数自动trim"],
        "summary": "特殊字符替换验证",
        "description": "零宽空格(\\u200B)和BOM(\\uFEFF)会被替换为空字符串。测试：传入包含零宽字符的值，返回值中零宽字符被移除。",
        "operationId": "autoTrimSanitize",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "content": { "type": "string", "example": "hello\u200Bworld" },
                  "title": { "type": "string", "example": "\uFEFF标题文字" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "content": { "type": "string", "example": "helloworld" },
                        "title": { "type": "string", "example": "标题文字" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/auto-trim/mixed": {
      "post": {
        "tags": ["参数自动trim"],
        "summary": "综合验证（trim+排除+替换）",
        "description": "表单参数 trim + 排除字段 + 特殊字符替换同时生效。name 被 trim，password（exclude-fields）保持原样，code 被 trim。",
        "operationId": "autoTrimMixed",
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "required": true,
            "schema": { "type": "string", "example": "  guardian  " },
            "description": "姓名（会被trim）"
          },
          {
            "name": "password",
            "in": "query",
            "required": true,
            "schema": { "type": "string", "example": "  secret123  " },
            "description": "密码（exclude-fields，不会被trim）"
          },
          {
            "name": "code",
            "in": "query",
            "required": true,
            "schema": { "type": "string", "example": "  ABC123  " },
            "description": "验证码（会被trim）"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "name": { "type": "string", "example": "guardian" },
                        "password": { "type": "string", "example": "  secret123  " },
                        "code": { "type": "string", "example": "ABC123" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/slow-api/fast": {
      "get": {
        "tags": ["慢接口检测"],
        "summary": "正常接口（立即返回）",
        "description": "立即返回，不触发慢接口检测。验证正常接口不会被记录。",
        "operationId": "slowApiFast",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/slow-api/slow": {
      "get": {
        "tags": ["慢接口检测"],
        "summary": "模拟慢接口（超全局阈值3000ms）",
        "description": "sleep 指定时间，默认 4000ms，超过全局阈值 3000ms 触发慢接口检测。查看控制台 WARN 日志及 /actuator/guardianSlowApi 端点。",
        "operationId": "slowApiSlow",
        "parameters": [
          {
            "name": "sleepMs",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 4000 },
            "description": "模拟耗时（毫秒），默认 4000"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/slow-api/custom-threshold": {
      "get": {
        "tags": ["慢接口检测"],
        "summary": "注解自定义阈值（@SlowApiThreshold 1000ms）",
        "description": "@SlowApiThreshold(1000)，阈值设为 1000ms。默认 sleep 1500ms 触发检测。",
        "operationId": "slowApiCustomThreshold",
        "parameters": [
          {
            "name": "sleepMs",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 1500 },
            "description": "模拟耗时（毫秒），默认 1500"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/slow-api/health": {
      "get": {
        "tags": ["慢接口检测"],
        "summary": "白名单接口（exclude-urls）",
        "description": "配置在 exclude-urls 中，无论耗时多长都不触发慢接口检测。默认 sleep 5000ms 验证白名单生效。",
        "operationId": "slowApiHealth",
        "parameters": [
          {
            "name": "sleepMs",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 5000 },
            "description": "模拟耗时（毫秒），默认 5000"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/slow-api/boundary": {
      "get": {
        "tags": ["慢接口检测"],
        "summary": "临界值验证（恰好3000ms）",
        "description": "sleep 恰好 3000ms，等于全局阈值。验证 duration >= threshold 时触发检测。",
        "operationId": "slowApiBoundary",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/trace/basic": {
      "get": {
        "tags": ["请求链路TraceId"],
        "summary": "基本TraceId",
        "description": "自动生成 TraceId，查看响应头 X-Trace-Id 和响应体中返回的 traceId。同时查看控制台日志中的 [traceId] 字段。",
        "operationId": "traceBasic",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "traceId": { "type": "string", "example": "143000a1b2c3d4e5" },
                        "description": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/trace/multi-log": {
      "get": {
        "tags": ["请求链路TraceId"],
        "summary": "模拟多层调用（Controller→Service→Dao）",
        "description": "同一请求内 Controller、Service、Dao 三层分别打日志，验证控制台输出的 traceId 完全一致。",
        "operationId": "traceMultiLog",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "traceId": { "type": "string", "example": "143000a1b2c3d4e5" },
                        "description": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/trace/passthrough": {
      "get": {
        "tags": ["请求链路TraceId"],
        "summary": "透传TraceId（请求头传入）",
        "description": "请求头携带 X-Trace-Id: my-custom-trace-123，验证 Filter 复用而非重新生成。响应头和响应体中的 traceId 应与传入值一致。",
        "operationId": "tracePassthrough",
        "parameters": [
          {
            "name": "X-Trace-Id",
            "in": "header",
            "required": false,
            "schema": { "type": "string", "example": "my-custom-trace-123" },
            "description": "自定义 TraceId（模拟上游服务传递）"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "traceId": { "type": "string", "example": "my-custom-trace-123" },
                        "description": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/trace/cross-thread": {
      "get": {
        "tags": ["请求链路TraceId"],
        "summary": "跨线程传递（TraceUtils.wrap）",
        "description": "使用 TraceUtils.wrap(Runnable) 和 TraceUtils.wrap(Callable) 将任务提交到子线程，验证子线程的 traceId 与主线程一致。查看控制台日志中主线程和子线程的 [traceId] 字段。",
        "operationId": "traceCrossThread",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "mainTraceId": { "type": "string", "example": "143000a1b2c3d4e5" },
                        "childTraceIds": {
                          "type": "array",
                          "items": { "type": "string" },
                          "example": ["143000a1b2c3d4e5", "143000a1b2c3d4e5"]
                        },
                        "allMatch": { "type": "boolean", "example": true },
                        "description": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/trace/completable-future": {
      "get": {
        "tags": ["请求链路TraceId"],
        "summary": "CompletableFuture跨线程传递",
        "description": "使用 TraceUtils.wrap(Executor) 包装线程池，配合 CompletableFuture 链式调用，验证所有异步任务的 traceId 与主线程一致。",
        "operationId": "traceCompletableFuture",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "mainTraceId": { "type": "string", "example": "143000a1b2c3d4e5" },
                        "task1TraceId": { "type": "string", "example": "143000a1b2c3d4e5" },
                        "task2TraceId": { "type": "string", "example": "143000a1b2c3d4e5" },
                        "allMatch": { "type": "boolean", "example": true },
                        "description": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/trace/get-trace-id": {
      "get": {
        "tags": ["请求链路TraceId"],
        "summary": "TraceUtils.getTraceId() 获取当前traceId",
        "description": "验证 TraceUtils.getTraceId() 工具方法返回值与 MDC.get(\"traceId\") 一致。适用于业务代码中需要主动获取 traceId 的场景。",
        "operationId": "traceGetTraceId",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "traceIdFromMdc": { "type": "string", "example": "143000a1b2c3d4e5" },
                        "traceIdFromUtils": { "type": "string", "example": "143000a1b2c3d4e5" },
                        "match": { "type": "string", "example": "true" },
                        "description": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/trace/switch-trace-id": {
      "get": {
        "tags": ["请求链路TraceId"],
        "summary": "TraceUtils.switchTraceId() 模拟MQ批量消费切换",
        "description": "模拟 MQ 批量消费场景，使用 TraceUtils.switchTraceId() 在循环中逐条切换 traceId。查看控制台日志中每条消息对应不同的 traceId，处理完成后恢复原始 traceId。",
        "operationId": "traceSwitchTraceId",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "originalTraceId": { "type": "string", "example": "143000a1b2c3d4e5" },
                        "switchRecords": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "msgTraceId": { "type": "string", "example": "msg-trace-001" },
                              "currentMdc": { "type": "string", "example": "msg-trace-001" }
                            }
                          }
                        },
                        "restoredTraceId": { "type": "string", "example": "143000a1b2c3d4e5" },
                        "description": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/trace/mq/rabbitmq/send": {
      "get": {
        "tags": ["MQ链路追踪-RabbitMQ"],
        "summary": "RabbitMQ 单条发送（traceId 自动注入）",
        "description": "发送一条 RabbitMQ 消息到 guardian.trace.test 交换机。Guardian 自动将当前 traceId 写入消息 Header。\n\n验证步骤：\n1. 调用本接口发送消息\n2. 查看控制台日志，消费端打印的 traceId 应与发送端一致\n3. 响应头 X-Trace-Id 即为本次链路 ID",
        "operationId": "traceRabbitSend",
        "parameters": [
          {
            "name": "message",
            "in": "query",
            "required": false,
            "schema": { "type": "string", "example": "Hello RabbitMQ" },
            "description": "消息内容，默认 Hello RabbitMQ"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "traceId": { "type": "string", "example": "143000a1b2c3d4e5" },
                        "message": { "type": "string", "example": "Hello RabbitMQ" },
                        "description": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/trace/mq/rabbitmq/send-batch": {
      "get": {
        "tags": ["MQ链路追踪-RabbitMQ"],
        "summary": "RabbitMQ 批量发送（switchTraceId 逐条切换）",
        "description": "发送多条消息到批量队列。消费端使用 List<Message> 批量接收，通过 TraceUtils.switchTraceId() 在循环中逐条切换 traceId。\n\n验证步骤：\n1. 调用本接口发送 N 条消息\n2. 查看控制台日志，每条消息的 traceId 应各自对应发送时的链路 ID",
        "operationId": "traceRabbitSendBatch",
        "parameters": [
          {
            "name": "count",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 3 },
            "description": "发送条数，默认 3"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "traceId": { "type": "string" },
                        "count": { "type": "integer", "example": 3 },
                        "description": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/trace/mq/kafka/send": {
      "get": {
        "tags": ["MQ链路追踪-Kafka"],
        "summary": "Kafka 单条发送（traceId 自动注入）",
        "description": "发送一条 Kafka 消息到 guardian-trace-test topic。Guardian 通过 ProducerInterceptor 自动将当前 traceId 写入消息 Header。\n\n验证步骤：\n1. 调用本接口发送消息\n2. 查看控制台日志，消费端打印的 traceId 应与发送端一致\n3. 响应头 X-Trace-Id 即为本次链路 ID",
        "operationId": "traceKafkaSend",
        "parameters": [
          {
            "name": "message",
            "in": "query",
            "required": false,
            "schema": { "type": "string", "example": "Hello Kafka" },
            "description": "消息内容，默认 Hello Kafka"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "traceId": { "type": "string", "example": "143000a1b2c3d4e5" },
                        "message": { "type": "string", "example": "Hello Kafka" },
                        "description": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/trace/mq/kafka/send-batch": {
      "get": {
        "tags": ["MQ链路追踪-Kafka"],
        "summary": "Kafka 批量发送（switchTraceId 逐条切换）",
        "description": "发送多条消息到批量 topic。消费端使用 List<ConsumerRecord> 批量接收，通过 TraceUtils.switchTraceId() 在循环中逐条切换 traceId。\n\n验证步骤：\n1. 调用本接口发送 N 条消息\n2. 查看控制台日志，每条消息的 traceId 应各自对应发送时的链路 ID",
        "operationId": "traceKafkaSendBatch",
        "parameters": [
          {
            "name": "count",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 3 },
            "description": "发送条数，默认 3"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "traceId": { "type": "string" },
                        "count": { "type": "integer", "example": 3 },
                        "description": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/trace/mq/rocketmq/send": {
      "get": {
        "tags": ["MQ链路追踪-RocketMQ"],
        "summary": "RocketMQ 单条发送（traceId 自动注入）",
        "description": "发送一条 RocketMQ 消息到 guardian-trace-test topic。Guardian 通过 SendMessageHook 自动将当前 traceId 写入消息 UserProperty。\n\n验证步骤：\n1. 调用本接口发送消息\n2. 查看控制台日志，消费端打印的 traceId 应与发送端一致\n3. 响应头 X-Trace-Id 即为本次链路 ID",
        "operationId": "traceRocketMQSend",
        "parameters": [
          {
            "name": "message",
            "in": "query",
            "required": false,
            "schema": { "type": "string", "example": "Hello RocketMQ" },
            "description": "消息内容，默认 Hello RocketMQ"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "traceId": { "type": "string", "example": "143000a1b2c3d4e5" },
                        "message": { "type": "string", "example": "Hello RocketMQ" },
                        "description": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/trace/mq/rocketmq/send-batch": {
      "get": {
        "tags": ["MQ链路追踪-RocketMQ"],
        "summary": "RocketMQ 批量发送（AOP 逐条自动注入 traceId）",
        "description": "发送多条消息到批量 topic。RocketMQ Spring Boot Starter 的 RocketMQListener 本身是逐条回调，AOP 切面会自动为每次调用注入/清理 traceId，无需手动切换。\n\n验证步骤：\n1. 调用本接口发送 N 条消息\n2. 查看控制台日志，每条消息的 traceId 应各自对应发送时的链路 ID",
        "operationId": "traceRocketMQSendBatch",
        "parameters": [
          {
            "name": "count",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 3 },
            "description": "发送条数，默认 3"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "traceId": { "type": "string" },
                        "count": { "type": "integer", "example": 3 },
                        "description": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/i18n/rate-limit": {
      "get": {
        "tags": ["消息国际化(i18n)"],
        "summary": "限流 i18n — 切换 Accept-Language 验证多语言拦截提示",
        "description": "注解 @RateLimit(qps=1, message=\"guardian.rate-limit.rejected\")。\n测试：快速请求 2 次触发限流，通过 Accept-Language 头切换语言：\n- zh-CN → 请求过于频繁，请稍后再试\n- en → Rate limit exceeded, please try again later\n- 不传 → 系统默认语言",
        "operationId": "i18nRateLimit",
        "parameters": [
          {
            "name": "Accept-Language",
            "in": "header",
            "required": false,
            "schema": { "type": "string", "example": "en" },
            "description": "语言标识：zh-CN（中文）/ en（英文）/ 不传（默认）"
          }
        ],
        "responses": {
          "200": {
            "description": "成功（未触发限流）",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string", "example": "限流 i18n 接口调用成功" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/i18n/repeat-submit": {
      "post": {
        "tags": ["消息国际化(i18n)"],
        "summary": "防重 i18n — 切换 Accept-Language 验证多语言拦截提示",
        "description": "注解 @RepeatSubmit(interval=10, message=\"guardian.repeat-submit.rejected\")。\n测试：10 秒内重复提交触发防重，通过 Accept-Language 头切换语言。",
        "operationId": "i18nRepeatSubmit",
        "parameters": [
          {
            "name": "Accept-Language",
            "in": "header",
            "required": false,
            "schema": { "type": "string", "example": "en" },
            "description": "语言标识：zh-CN（中文）/ en（英文）/ 不传（默认）"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "orderId": { "type": "string", "example": "ORDER-001" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功（首次提交）",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/i18n/idempotent": {
      "post": {
        "tags": ["消息国际化(i18n)"],
        "summary": "幂等 i18n — Token 无效/已消费时验证多语言拦截提示",
        "description": "注解 @Idempotent(value=\"i18n-order\", message=\"guardian.idempotent.rejected\")。\n测试步骤：\n1. 先获取 Token：GET /guardian/idempotent/token?key=i18n-order\n2. 携带 Token 请求本接口（首次成功）\n3. 再次携带相同 Token 请求（触发幂等拦截，返回国际化消息）",
        "operationId": "i18nIdempotent",
        "parameters": [
          {
            "name": "X-Idempotent-Token",
            "in": "header",
            "required": true,
            "schema": { "type": "string", "example": "从 /guardian/idempotent/token 获取" },
            "description": "幂等 Token"
          },
          {
            "name": "Accept-Language",
            "in": "header",
            "required": false,
            "schema": { "type": "string", "example": "en" },
            "description": "语言标识：zh-CN（中文）/ en（英文）/ 不传（默认）"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "orderId": { "type": "string", "example": "ORDER-001" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功（Token 首次消费）",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/i18n/idempotent/missing-token": {
      "post": {
        "tags": ["消息国际化(i18n)"],
        "summary": "幂等 i18n — 不传 Token 验证 missing-token-message 国际化",
        "description": "注解 @Idempotent(value=\"i18n-missing-token\")，故意不传 Token 触发缺少 Token 拦截。\nYAML 配置 missing-token-message: guardian.idempotent.missing-token，通过 Accept-Language 切换语言。",
        "operationId": "i18nIdempotentMissingToken",
        "parameters": [
          {
            "name": "Accept-Language",
            "in": "header",
            "required": false,
            "schema": { "type": "string", "example": "en" },
            "description": "语言标识：zh-CN（中文）/ en（英文）/ 不传（默认）"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "orderId": { "type": "string", "example": "ORDER-001" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "不会到达（一定被拦截）",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 500 },
                    "message": { "type": "string", "example": "Missing idempotent token" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ip-filter/open": {
      "get": {
        "tags": ["IP黑白名单"],
        "summary": "普通接口 — 黑名单外均可访问",
        "description": "不在黑名单且不受白名单约束时可正常访问。默认配置下本机 IP 不在黑名单，请求成功。\n拒绝提示支持 i18n，通过 Accept-Language 切换语言。",
        "operationId": "ipFilterOpen",
        "parameters": [
          {
            "name": "Accept-Language",
            "in": "header",
            "required": false,
            "schema": { "type": "string", "example": "en" },
            "description": "语言标识：zh-CN（中文）/ en（英文）/ 不传（默认）"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string", "example": "此接口不受白名单限制，黑名单外均可访问" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ip-filter/admin/dashboard": {
      "get": {
        "tags": ["IP黑白名单"],
        "summary": "白名单接口 — 仅白名单 IP 可访问",
        "description": "配置了 URL 绑定白名单（/ip-filter/admin/**），仅 127.0.0.1 可访问（IPv6 环回自动转为 127.0.0.1）。本机请求成功，其他 IP 被拒绝。\n拒绝提示支持 i18n，通过 Accept-Language 切换语言。",
        "operationId": "ipFilterAdminDashboard",
        "parameters": [
          {
            "name": "Accept-Language",
            "in": "header",
            "required": false,
            "schema": { "type": "string", "example": "en" },
            "description": "语言标识：zh-CN（中文）/ en（英文）/ 不传（默认）"
          }
        ],
        "responses": {
          "200": {
            "description": "成功（白名单 IP）",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string", "example": "白名单接口访问成功" }
                  }
                }
              }
            }
          },
          "403": {
            "description": "拒绝（非白名单 IP）",
            "content": {
              "application/json": {
                "examples": {
                  "中文": {
                    "value": { "code": 403, "msg": "IP访问被拒绝", "timestamp": 1740000000000 }
                  },
                  "英文": {
                    "value": { "code": 403, "msg": "IP access denied", "timestamp": 1740000000000 }
                  }
                },
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 403 },
                    "msg": { "type": "string", "example": "IP访问被拒绝" },
                    "timestamp": { "type": "integer" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ip-filter/admin/settings": {
      "get": {
        "tags": ["IP黑白名单"],
        "summary": "白名单接口 — 管理后台设置页",
        "description": "同属 /ip-filter/admin/** 白名单规则，仅白名单 IP 可访问。\n拒绝提示支持 i18n，通过 Accept-Language 切换语言。",
        "operationId": "ipFilterAdminSettings",
        "parameters": [
          {
            "name": "Accept-Language",
            "in": "header",
            "required": false,
            "schema": { "type": "string", "example": "en" },
            "description": "语言标识：zh-CN（中文）/ en（英文）/ 不传（默认）"
          }
        ],
        "responses": {
          "200": {
            "description": "成功（白名单 IP）",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string", "example": "管理后台设置页访问成功" }
                  }
                }
              }
            }
          },
          "403": {
            "description": "拒绝（非白名单 IP）",
            "content": {
              "application/json": {
                "examples": {
                  "中文": {
                    "value": { "code": 403, "msg": "IP访问被拒绝", "timestamp": 1740000000000 }
                  },
                  "英文": {
                    "value": { "code": 403, "msg": "IP access denied", "timestamp": 1740000000000 }
                  }
                },
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 403 },
                    "msg": { "type": "string", "example": "IP访问被拒绝" },
                    "timestamp": { "type": "integer" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ip-filter/test-black": {
      "get": {
        "tags": ["IP黑白名单"],
        "summary": "黑名单测试 — 将本机 IP 加入黑名单后被拦截",
        "description": "默认配置下本机 IP 不在黑名单，请求成功。将 127.0.0.1 加入 black-list 后该接口返回 403。\n拒绝提示支持 i18n，通过 Accept-Language 切换语言。",
        "operationId": "ipFilterTestBlack",
        "parameters": [
          {
            "name": "Accept-Language",
            "in": "header",
            "required": false,
            "schema": { "type": "string", "example": "en" },
            "description": "语言标识：zh-CN（中文）/ en（英文）/ 不传（默认）"
          }
        ],
        "responses": {
          "200": {
            "description": "成功（不在黑名单中）",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string", "example": "未被黑名单拦截，访问成功" }
                  }
                }
              }
            }
          },
          "403": {
            "description": "拒绝（在黑名单中）",
            "content": {
              "application/json": {
                "examples": {
                  "中文": {
                    "value": { "code": 403, "msg": "IP访问被拒绝", "timestamp": 1740000000000 }
                  },
                  "英文": {
                    "value": { "code": 403, "msg": "IP access denied", "timestamp": 1740000000000 }
                  }
                },
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 403 },
                    "msg": { "type": "string", "example": "IP访问被拒绝" },
                    "timestamp": { "type": "integer" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/actuator/guardianRateLimit": {
      "get": {
        "tags": ["Actuator监控端点"],
        "summary": "接口限流监控",
        "description": "查看接口限流的运行时统计数据，包括：总请求数、通过数、拦截数、拦截率、被拦截接口排行、高频接口排行、接口维度明细。支持通过查询参数控制各排行返回条数。",
        "operationId": "actuatorRateLimit",
        "parameters": [
          {
            "name": "blockedTop",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 10 },
            "description": "被拦截接口 Top N，默认 10"
          },
          {
            "name": "requestTop",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 10 },
            "description": "高频请求接口 Top N，默认 10"
          },
          {
            "name": "detailsTop",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 10 },
            "description": "接口维度明细 Top N，默认 10"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "totalRequestCount": { "type": "integer", "example": 150 },
                    "totalPassCount": { "type": "integer", "example": 140 },
                    "totalBlockCount": { "type": "integer", "example": 10 },
                    "blockRate": { "type": "string", "example": "6.67%" },
                    "topBlockedApis": {
                      "type": "array",
                      "items": { "type": "object" },
                      "example": [{ "api": "/rate-limit/annotation/strict", "blockCount": 5 }]
                    },
                    "topRequestApis": {
                      "type": "array",
                      "items": { "type": "object" },
                      "example": [{ "api": "/rate-limit/annotation/global", "requestCount": 50 }]
                    },
                    "apiDetails": {
                      "type": "array",
                      "items": { "type": "object" },
                      "example": [{ "api": "/rate-limit/annotation/global", "requestCount": 50, "passCount": 48, "blockCount": 2 }]
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/actuator/guardianApiSwitch": {
      "get": {
        "tags": ["Actuator监控端点"],
        "summary": "接口开关监控",
        "description": "查看接口开关运行时关闭的接口列表。",
        "operationId": "actuatorApiSwitch",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "disabledUrls": ["/api-switch/disabled"]
                  }
                }
              }
            }
          }
        }
      }
    },
    "/actuator/guardianApiSwitch/{urlPattern}": {
      "post": {
        "tags": ["Actuator监控端点"],
        "summary": "接口开关-关闭接口",
        "description": "通过 POST 方式关闭指定接口，urlPattern 支持 AntPath 通配符。",
        "operationId": "actuatorApiSwitchDisable",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "action": { "type": "string", "example": "disabled" },
                    "urlPattern": { "type": "string", "example": "/api-switch/actuator-disabled" },
                    "disabledUrls": { "type": "array", "example": ["/api-switch/disabled"] }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Actuator监控端点"],
        "summary": "接口开关-开启接口",
        "description": "通过 DELETE 方式开启指定接口，urlPattern 支持 AntPath 通配符。",
        "operationId": "actuatorApiSwitchEnable",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "action": "enabled",
                    "urlPattern": "/api-switch/actuator-disabled",
                    "disabledUrls": ["/api-switch/disabled"]
                  }
                }
              }
            }
          }
        }
      }
    },
    "/actuator/guardianRepeatSubmit": {
      "get": {
        "tags": ["Actuator监控端点"],
        "summary": "防重复提交监控",
        "description": "查看防重复提交的运行时统计数据，包括：总拦截数、总通过数、被拦截接口排行。支持通过查询参数控制排行返回条数。",
        "operationId": "actuatorRepeatSubmit",
        "parameters": [
          {
            "name": "top",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 10 },
            "description": "被拦截接口 Top N，默认 10"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "totalBlockCount": { "type": "integer", "example": 8 },
                    "totalPassCount": { "type": "integer", "example": 120 },
                    "topBlockedApis": {
                      "type": "array",
                      "items": { "type": "object" },
                      "example": [{ "api": "/repeat-submit/annotation/user-scope", "blockCount": 3 }]
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/actuator/guardianIdempotent": {
      "get": {
        "tags": ["Actuator监控端点"],
        "summary": "接口幂等监控",
        "description": "查看接口幂等的运行时统计数据，包括：总请求数、通过数、拦截数、拦截率、被拦截接口排行。支持通过查询参数控制排行返回条数。",
        "operationId": "actuatorIdempotent",
        "parameters": [
          {
            "name": "top",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 10 },
            "description": "被拦截接口 Top N，默认 10"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "totalRequestCount": { "type": "integer", "example": 60 },
                    "totalPassCount": { "type": "integer", "example": 55 },
                    "totalBlockCount": { "type": "integer", "example": 5 },
                    "blockRate": { "type": "string", "example": "8.33%" },
                    "topBlockedApis": {
                      "type": "array",
                      "items": { "type": "object" },
                      "example": [{ "api": "/idempotent/header", "blockCount": 3 }]
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/actuator/guardianSlowApi": {
      "get": {
        "tags": ["Actuator监控端点"],
        "summary": "慢接口检测监控",
        "description": "查看慢接口检测的运行时统计数据，包括：慢接口触发总次数、慢接口排行（含触发次数、最大耗时、最近耗时明细记录）。支持通过查询参数控制排行和明细返回条数。",
        "operationId": "actuatorSlowApi",
        "parameters": [
          {
            "name": "top",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 10 },
            "description": "慢接口排行 Top N，默认 10"
          },
          {
            "name": "recordTop",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 5 },
            "description": "每个接口返回的耗时明细记录条数，默认 5，最大 100"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "totalSlowCount": { "type": "integer", "example": 23 },
                    "topSlowApis": {
                      "type": "object",
                      "example": {
                        "/api/report/export": {
                          "count": 12,
                          "maxDuration": 8520,
                          "recentRecords": [
                            { "duration": 8520, "time": "2026-02-09 15:32:10" },
                            { "duration": 6230, "time": "2026-02-09 14:20:45" }
                          ]
                        },
                        "/api/order/create": {
                          "count": 7,
                          "maxDuration": 5230,
                          "recentRecords": [
                            { "duration": 5230, "time": "2026-02-09 15:10:02" }
                          ]
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/actuator/guardianIpFilter": {
      "get": {
        "tags": ["Actuator监控端点"],
        "summary": "IP黑白名单监控",
        "description": "查看 IP 黑白名单的运行时统计数据，包括：黑名单拦截总数、白名单拦截总数、被拦截 IP 排行。支持通过查询参数控制排行返回条数。",
        "operationId": "actuatorIpFilter",
        "parameters": [
          {
            "name": "blockTop",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 10 },
            "description": "黑名单拦截 IP Top N，默认 10"
          },
          {
            "name": "whiteTop",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 10 },
            "description": "白名单拦截请求 Top N，默认 10"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "totalBlackListBlockCount": { "type": "integer", "example": 5 },
                    "totalWhiteListBlockCount": { "type": "integer", "example": 2 },
                    "topBlackListBlocked": {
                      "type": "array",
                      "items": { "type": "object" },
                      "example": [{ "ip": "192.168.100.100", "count": 3 }]
                    },
                    "topWhiteListBlocked": {
                      "type": "array",
                      "items": { "type": "object" },
                      "example": [{ "ip": "10.0.0.5", "uri": "/ip-filter/admin/dashboard", "count": 2 }]
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/actuator/guardianAntiReplay": {
      "get": {
        "tags": ["Actuator监控端点"],
        "summary": "防重放攻击监控",
        "description": "查看防重放攻击的运行时统计数据，包括：总请求数、通过数、拦截数、拦截率、被拦截接口排行。支持通过查询参数控制排行返回条数。",
        "operationId": "actuatorAntiReplay",
        "parameters": [
          {
            "name": "top",
            "in": "query",
            "required": false,
            "schema": { "type": "integer", "example": 10 },
            "description": "被拦截接口 Top N，默认 10"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "totalRequestCount": { "type": "integer", "example": 5000 },
                    "totalPassCount": { "type": "integer", "example": 4980 },
                    "totalBlockCount": { "type": "integer", "example": 20 },
                    "blockRate": { "type": "string", "example": "0.40%" },
                    "topBlockedApis": {
                      "type": "object",
                      "example": { "/api/payment/submit": 12, "/api/transfer/confirm": 8 }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/anti-replay/protected/query": {
      "get": {
        "tags": ["防重放攻击"],
        "summary": "受保护接口 — GET 查询",
        "description": "请求头必须携带 X-Timestamp（当前毫秒时间戳）和 X-Nonce（UUID），缺失或校验失败将被拦截。\n测试步骤：\n1. 先调用 /anti-replay/helper/generate-params 获取参数\n2. 将返回的 X-Timestamp 和 X-Nonce 填入请求头\n3. 发送请求，首次成功\n4. 使用相同 Nonce 再次发送，被拦截（重复请求）",
        "operationId": "antiReplayProtectedQuery",
        "parameters": [
          {
            "name": "X-Timestamp",
            "in": "header",
            "required": true,
            "schema": { "type": "string", "example": "1708000000000" },
            "description": "请求发起时间戳（毫秒）"
          },
          {
            "name": "X-Nonce",
            "in": "header",
            "required": true,
            "schema": { "type": "string", "example": "a1b2c3d4e5f6" },
            "description": "请求唯一标识（UUID）"
          },
          {
            "name": "keyword",
            "in": "query",
            "required": false,
            "schema": { "type": "string", "example": "guardian" }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/anti-replay/protected/submit": {
      "post": {
        "tags": ["防重放攻击"],
        "summary": "受保护接口 — POST 提交",
        "description": "模拟支付等敏感操作，必须携带有效的 X-Timestamp 和 X-Nonce。\n测试：使用相同 Nonce 重复提交，第二次被拦截。",
        "operationId": "antiReplayProtectedSubmit",
        "parameters": [
          {
            "name": "X-Timestamp",
            "in": "header",
            "required": true,
            "schema": { "type": "string", "example": "1708000000000" },
            "description": "请求发起时间戳（毫秒）"
          },
          {
            "name": "X-Nonce",
            "in": "header",
            "required": true,
            "schema": { "type": "string", "example": "a1b2c3d4e5f6" },
            "description": "请求唯一标识（UUID）"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": { "type": "string" },
                "example": { "orderId": "ORD001", "amount": "99.99" }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/anti-replay/open/health": {
      "get": {
        "tags": ["防重放攻击"],
        "summary": "白名单接口 — 不受防重放限制",
        "description": "此接口被 exclude-urls 排除（/anti-replay/open/**），无需携带 X-Timestamp 和 X-Nonce，直接访问即可成功。",
        "operationId": "antiReplayOpenHealth",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/anti-replay/helper/generate-params": {
      "get": {
        "tags": ["防重放攻击"],
        "summary": "辅助接口 — 生成测试参数",
        "description": "返回当前时间戳和一个随机 Nonce，方便在 Apifox / Postman 中测试防重放接口。将返回值中的 X-Timestamp 和 X-Nonce 复制到请求头即可。",
        "operationId": "antiReplayGenerateParams",
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "X-Timestamp": { "type": "string", "example": "1708000000000" },
                        "X-Nonce": { "type": "string", "example": "a1b2c3d4e5f6g7h8i9j0" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api-switch/un-disabled": {
  "get": {
    "tags": ["接口开关"],
    "summary": "正常接口 — 立即返回，不触发接口关闭",
    "description": "正常接口，不触发接口开关检测。",
    "operationId": "apiSwitchUnDisabled",
    "responses": {
      "200": {
        "description": "成功",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "code": { "type": "integer", "example": 200 },
                "message": { "type": "string", "example": "success" },
                "data": { "type": "string" }
              }
            }
          }
        }
      }
    }
  }
},
"/api-switch/disabled": {
  "get": {
    "tags": ["接口开关"],
    "summary": "yml关闭接口 — 通过yml配置关闭接口",
    "description": "通过yml配置关闭接口，触发接口开关检测。",
    "operationId": "apiSwitchDisabled",
    "responses": {
      "200": {
        "description": "成功",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "code": { "type": "integer", "example": 200 },
                "message": { "type": "string", "example": "success" },
                "data": { "type": "string" }
              }
            }
          }
        }
      }
    }
  }
},
"/api-switch/actuator-disabled": {
  "get": {
    "tags": ["接口开关"],
    "summary": "actuator关闭接口 — 通过actuator配置关闭接口",
    "description": "通过actuator配置关闭接口，触发接口开关检测。",
    "operationId": "apiSwitchActuatorDisabled",
    "responses": {
      "200": {
        "description": "成功",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "code": { "type": "integer", "example": 200 },
                "message": { "type": "string", "example": "success" },
                "data": { "type": "string" }
              }
            }
          }
        }
      }
    }
  }
}
  }
}
